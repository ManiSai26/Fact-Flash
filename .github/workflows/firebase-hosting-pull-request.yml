# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting (LIVE - Manual Trigger)
# This trigger allows you to manually run the workflow from the GitHub Actions tab.
on: workflow_dispatch
permissions:
  checks: write
  contents: read

jobs:
  # Job renamed for clarity (targeting production/live)
  build_and_deploy_live:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      # 1. Setup Flutter SDK (Fixes 'flutter: command not found')
      - name: Setup Flutter
        uses: subosito/flutter-action@v2 
        with:
          channel: 'stable'
          
      # 2. Get dependencies
      - name: Get Flutter dependencies
        run: flutter pub get
          
      # 3. Build web assets
      - name: Build Flutter Web
        run: flutter build web
        
      # 4. Deploy to Firebase LIVE Hosting Channel
      - name: Deploy to Firebase Live Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }}
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_FACT_FLASH }}
          projectId: fact-flash
          # ðŸ‘‡ CRITICAL FIX: Explicitly setting channelId to 'live' forces a production deploy 
          # and stops the action from incorrectly using the 'hosting:channel:deploy' command.
          channelId: live
